<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Offside Calculator Pro AI v4.0</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2300ff87'/%3E%3Cstop offset='100%25' style='stop-color:%2300b894'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='%230f172a'/%3E%3Cline x1='10' y1='80' x2='50' y2='30' stroke='%233b82f6' stroke-width='3' stroke-linecap='round'/%3E%3Cline x1='30' y1='85' x2='50' y2='30' stroke='%233b82f6' stroke-width='3' stroke-linecap='round'/%3E%3Cline x1='50' y1='90' x2='50' y2='30' stroke='%233b82f6' stroke-width='3' stroke-linecap='round'/%3E%3Cline x1='70' y1='85' x2='50' y2='30' stroke='%233b82f6' stroke-width='3' stroke-linecap='round'/%3E%3Cline x1='90' y1='80' x2='50' y2='30' stroke='%233b82f6' stroke-width='3' stroke-linecap='round'/%3E%3Ccircle cx='50' cy='30' r='6' fill='url(%23g)' stroke='%2300ff87' stroke-width='2'/%3E%3Ctext x='50' y='70' text-anchor='middle' fill='%23f97316' font-size='20' font-weight='bold'%3EAI%3C/text%3E%3C/svg%3E">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
  <header class="header">
    <div class="logo">
      <div class="logo-icon">&#9917;</div>
      Offside Calc
      <span class="version-badge">AI v4.0</span>
    </div>

    <div class="divider"></div>

    <button class="btn btn-primary" id="btnOpen">
      <span>&#128194;</span>
      <span data-i18n="openImage">Open Image</span>
    </button>
    <input type="file" id="fileInput" accept="image/*" style="display:none">

    <div class="divider"></div>

    <div class="tool-group">
      <button class="tool-btn active" data-tool="select" title="Select (V)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"/></svg>
      </button>
      <button class="tool-btn" data-tool="draw" title="Reference Line (L)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="19" x2="19" y2="5"/></svg>
      </button>
      <button class="tool-btn" data-tool="vpLine" title="Offside Line (P)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><line x1="12" y1="2" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="22"/><line x1="2" y1="12" x2="6" y2="12"/><line x1="18" y1="12" x2="22" y2="12"/></svg>
      </button>
      <button class="tool-btn" data-tool="player" title="Player Projection (Y)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="3"/><line x1="12" y1="8" x2="12" y2="21"/><line x1="8" y1="21" x2="16" y2="21"/></svg>
      </button>
      <button class="tool-btn" data-tool="delete" title="Delete (D)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3,6 5,6 21,6"/><path d="M19,6v14a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6m3,0V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2v2"/></svg>
      </button>
      <button class="tool-btn" data-tool="pan" title="Pan (H)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"/></svg>
      </button>
    </div>

    <div class="divider"></div>

    <div class="tool-group">
      <button class="tool-btn" id="btnUndo" title="Undo"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7v6h6"/><path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"/></svg></button>
      <button class="tool-btn" id="btnRedo" title="Redo"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 7v6h-6"/><path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"/></svg></button>
    </div>

    <div class="divider"></div>

    <div class="tool-group">
      <button class="tool-btn" id="btnZoomOut" title="Zoom Out"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="8" y1="11" x2="14" y2="11"/></svg></button>
      <button class="tool-btn" id="btnZoomIn" title="Zoom In"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg></button>
      <button class="tool-btn" id="btnFit" title="Fit to View"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg></button>
    </div>

    <div class="stats">
      <div class="stat-item"><div class="stat-dot source"></div><span data-i18n="sourceLines">Source</span>: <strong id="sourceCount">0</strong></div>
      <div class="stat-item"><div class="stat-dot vp"></div><span>VP</span>: <strong id="vpCount">0</strong></div>
      <div class="vp-coords" id="vpCoords">VP: --</div>
    </div>
  </header>

  <main class="main">
    <div class="canvas-container" id="canvasContainer">
      <canvas id="canvas"></canvas>
      <div class="empty-state" id="emptyState">
        <div class="empty-state-icon">&#9917;</div>
        <h3 data-i18n="emptyTitle">Load an image to begin</h3>
        <p data-i18n="emptyDescAI">AI will automatically detect field lines</p>
      </div>
      <div class="zoom-indicator" id="zoomIndicator">100%</div>
    </div>

    <aside class="sidebar">
      <!-- AI Detection Panel -->
      <div id="aiPanelContainer"></div>

      <div class="sidebar-section">
        <div class="sidebar-title" data-i18n="language">Language</div>
        <div class="lang-toggle">
          <button class="lang-btn active" data-lang="en">English</button>
          <button class="lang-btn" data-lang="it">Italiano</button>
        </div>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title" data-i18n="vanishingPoint">Vanishing Point</div>
        <div class="vp-info" id="vpInfo">
          <div class="vp-info-row"><span class="vp-info-label">X:</span><span class="vp-info-value" id="vpX">--</span></div>
          <div class="vp-info-row"><span class="vp-info-label">Y:</span><span class="vp-info-value" id="vpY">--</span></div>
          <div class="vp-status" id="vpStatus"><span data-i18n="drawLines">Draw at least 2 lines</span></div>
        </div>
        <button class="btn btn-secondary sidebar-btn" id="btnRecalc"><span data-i18n="recalculate">Recalculate</span></button>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title" data-i18n="export">Export</div>
        <div class="export-grid">
          <button class="btn btn-secondary" id="btnExport" data-i18n="exportImage">Export Image</button>
          <button class="btn btn-secondary" id="btnExportExt" data-i18n="exportExtended">Export Extended</button>
        </div>
      </div>

      <div class="shortcuts">
        <div class="sidebar-title" data-i18n="shortcuts">Shortcuts</div>
        <div class="shortcut-item"><span data-i18n="select">Select</span><span class="shortcut-key">V</span></div>
        <div class="shortcut-item"><span data-i18n="drawLine">Draw Line</span><span class="shortcut-key">L</span></div>
        <div class="shortcut-item"><span data-i18n="vpLineShort">VP Line</span><span class="shortcut-key">P</span></div>
        <div class="shortcut-item"><span data-i18n="playerTool">Player</span><span class="shortcut-key">Y</span></div>
        <div class="shortcut-item"><span data-i18n="deleteTool">Delete</span><span class="shortcut-key">D</span></div>
        <div class="shortcut-item"><span data-i18n="panTool">Pan</span><span class="shortcut-key">H</span></div>
        <div class="shortcut-item"><span data-i18n="moveVP">Move VP</span><span class="shortcut-key">Arrows</span></div>
        <div class="shortcut-item"><span data-i18n="undo">Undo</span><span class="shortcut-key">Ctrl+Z</span></div>
        <div class="shortcut-item"><span data-i18n="help">Help</span><span class="shortcut-key">F1</span></div>
      </div>
    </aside>
  </main>

  <footer class="status-bar">
    <div class="status-hint" id="statusHint" data-i18n="statusSelect">Click to select. Drag VP or use arrow keys.</div>
    <button class="btn btn-ghost" id="btnTutorial" data-i18n="startTutorial">Tutorial</button>
  </footer>

  <button class="help-btn" id="btnHelp" title="Help (F1)">?</button>

  <div class="modal-overlay" id="helpModal">
    <div class="modal">
      <div class="modal-header">
        <h2 class="modal-title" data-i18n="guideTitle">User Guide</h2>
        <button class="modal-close" id="btnCloseHelp">&times;</button>
      </div>
      <div class="modal-tabs">
        <button class="modal-tab active" data-tab="quickstart" data-i18n="tabQuickstart">Quick Start</button>
        <button class="modal-tab" data-tab="theory" data-i18n="tabTheory">Theory</button>
        <button class="modal-tab" data-tab="tools" data-i18n="tabTools">Tools</button>
        <button class="modal-tab" data-tab="about" data-i18n="tabAbout">About</button>
      </div>
      <div class="modal-content" id="modalContent"></div>
    </div>
  </div>

  <script type="module" src="/src/main.js"></script>
</body>
</html>
